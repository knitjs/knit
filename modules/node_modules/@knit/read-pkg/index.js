import rp from 'read-pkg';

import pathJoin from '@knit/path-join';

type TReadPkg = (m: string, p: TPaths) => TPkgJson;
export default (mod, paths): TReadPkg => {
  try {
    return rp.sync(pathJoin(paths.modules, mod), {
      normalize: false,
    });
  } catch (err) {
    throw {
      message: `could not find a \`package.json\` in ${pathJoin(paths.modulesStub, mod)}.`,
      stderr: `All directories under ${paths.modulesStub} are expected to be node modules. To ignore a directory add a 'private: true' to the package.json.`,
    };
  }
};
